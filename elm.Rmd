---
title: "Extreme learning machine"
author: "Rubens Oliveira da Cunha Junior"
date: "12/08/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
# importa função implementada
source('./elm.R')

# carrega o pacote
library('elmNNRcpp')

# carrega o conjunto de dados
data("Boston", package = 'KernelKnn')
```

```{r modelos}
# Modelo linear
fit_lm = lm(medv~., data = Boston[1:350, ])
 
# pacote elmNNRcpp
Boston = as.matrix(Boston)
# dimnames(Boston) = NULL

X = Boston[, -dim(Boston)[2]]
xtr = X[1:350, ]
ytr = matrix(Boston[1:350, dim(Boston)[2]],
             nrow = length(Boston[1:350, dim(Boston)[2]]),
             ncol = 1)

xte = X[351:nrow(X), ]
yte = Boston[351:nrow(X), dim(Boston)[2]]

fit_elm = elm_train(xtr,
                    ytr,
                    nhid = 1000,
                    actfun = 'purelin',
                    init_weights = "uniform_negative",
                    bias = TRUE,
                    verbose = T)

# implementação
imp_elm <- my.elm(Y = ytr,
                  X = xtr,
                  h = 1000,
                  act.fun = identity,
                  dist.fun = runif,
                  min = -1,
                  max = 1)

```

```{r previsão}
pr_te_elm = elmNNRcpp::elm_predict(fit_elm, xte)
pr_te_imp <- predict.elm(imp_elm, xte)
pr_te_lm = predict(fit_lm, newdata = as.data.frame(Boston[351:nrow(X), ]))
```

```{r medida de desempenho}
rmse <- function (obs, est) sqrt(mean((obs - est)^2))
```

```{r avalia desempenho}
# Teste
rmse(yte, pr_te_elm[, 1])
rmse(yte, pr_te_imp[, 1])
rmse(yte, pr_te_lm)

```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
